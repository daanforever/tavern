- content_for :header do
  %h1 
    Projects
    = link_to refresh_registries_path, remote: true, id: 'refresh', class: 'btn btn-default btn-rotate', title: 'Refresh' do
      %span.glyphicon.glyphicon-repeat
      = t('.scan')

%table.table
  %thead
    %tr
      %th.col-md-4
      %th.col-md-2 Releases
      %th.col-md-3 Environments
      %th.col-md-3 Components
  %tbody
    - @projects.includes(:releases).each do |project|
      %tr
        %td
          %blockquote
            %p
              = link_to project.name, project
              %small= project.description


        %td
          - project.releases.each do |release|
            %p
              = link_to release.name, release_path(release)
              - if release.active?
                %span.glyphicon.glyphicon-ok.text-success

        %td
          - if project.environments.count == 0
            %p.row
              %span.col-md-12
                = link_to new_project_environment_path(project), class: 'btn btn-default btn-sm btn-rotate' do
                  %span.glyphicon.glyphicon-plus
                  = t('.new_environment')
          - project.environments.each do |environment|
            %p.row
              %span.col-md-6
                = link_to environment.name, environment
              %span.col-md-6.visible-md-inline-block.visible-lg-inline-block
                = link_to environment_hosts_path(environment) do
                  %span.badge= pluralize( environment.hosts.count, t(:hosts, default: 'host') )

        %td
          - project.components.each do |component|
            %p
              %b
                = link_to component.name, component_path(component)
              = link_to component_instances_path(component) do
                %span.badge= pluralize( component.instances.count, t(:instances, default: 'instance') )
